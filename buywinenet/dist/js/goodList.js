"use strict";$(function(){var t=!0;function a(t){var a=JSON.parse(t),n=a.list.map(function(t){return'<li data-id="'+t.id+'">\n            <a href="javascript:void(0)">\n                <img src="'+t.img+'" alt="">\n            </a>\n            <span class="item-name">\n            '+t.itemname+'\n            </span>\n            <span class="pretype">\n                <em>'+t.pretype+"</em>\n                "+t.pretypetitle+'\n            </span>\n            <span class="item-price ">\n                <em>￥</em>\n                <span>'+t.itemprice+'</span>\n            </span>\n            <a class="shop-car fr" href="javascript:void(0)" style="color:white">\n               加入购物车\n            </a>\n            <span class="assnum ">评价:<em>'+t.assnum+'</em>条&nbsp;库存：<em class="kucun">'+t.inventory+"</em></span>\n            \n        </li>"}).join("");o.html(n);for(var i=a.total,s=Math.ceil(i/a.qty),e="",p=0;p<s;p++)e+="\n            <span>"+(p+1)+"</span>\n            ";c.html(e),c.append(" <section>“葡萄酒”有<em> <a href='javascript:void(0)' style='color:red'>"+i+"</a></em>条相关商品</section>"),c.children(":nth-child(1)").addClass("pageactive")}function i(t,a){var n=JSON.parse(t).list.map(function(t){return'<li data-id="'+t.id+'">\n        <a href="javascript:void(0)">\n            <img src="'+t.img+'" alt="">\n            </a>\n            <span class="item-name">\n                '+t.itemname+'\n            </span>\n            <span class="pretype">\n                <em>'+t.pretype+"</em>\n                "+t.pretypetitle+'\n            </span>\n            <span class="item-price ">\n                <em>￥</em>\n                <span>'+t.itemprice+'</span>\n            </span>\n            <a class="shop-car fr" href="javascript:void(0)" style="color:white">\n                加入购物车\n            </a>\n            <span class="assnum ">评价:<em>'+t.assnum+'</em>条&nbsp;库存：<em  class="kucun">'+t.inventory+"</em></span>\n        </li>"}).join("");o.html(n);for(var i=0;i<c.children.length;i++)c.children(i).removeClass("pageactive");a.target.className="pageactive"}$(".rqpp-more").click(function(){t=(t?($(".rqpp-more").html("收起∧"),$(".rqpp-table").css("max-height","none")):($(".rqpp-more").html("展开∨"),$(".rqpp-table").css("max-height","120px")),!t)}),window.onscroll=function(){800<=window.scrollY?$(".goodlisttopMenu").css("top",0):$(".goodlisttopMenu").css("top",-100)};var o=$("#goodlist"),c=$("#page");$("#goodlist").on("click","li",function(t){t=t||window.event;var a=$(this).attr("data-id");location.href="../html/goodDetails.html?"+a,t.stopPropagation()}),$("#goodlist").on("click",".shop-car",function(t){if("shop-car"==(t=t||window.event).target.className.substr(0,8)){var a=$("#end").offset(),n=$(this).parent().find("img").attr("src");$('<img class="u-flyer" src="'+n+'">').fly({start:{left:t.clientX,top:t.clientY},end:{left:a.left,top:a.top-window.scrollY+30,width:0,height:0},onEnd:function(){$("#msg").show().animate({width:"250px"},200).fadeOut(1e3)}})}t.stopPropagation();var i=$(this).parent().attr("data-id"),s=$(this).parent().find(".item-name").html(),e=$(this).parent().find("img").attr("src"),p=1*$(this).parent().find(".item-price span").html(),o=1*$(this).parent().find(".assnum .kucun").html();$.ajax({type:"post",url:"../api/shopcar.php",data:{id:i,name:s,imgurl:e,price:p,qty:1,inventory:o,m:"add"},success:function(t){}})});var n=$("#wantbuy"),s=parseInt(8*Math.random())+1;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:4,page:s,m:"show"},success:function(t){var a=JSON.parse(t).list.map(function(t){return'<li data-id="'+t.id+'">\n                            <a href="javascript:void(0)">\n                                <img src="'+t.img+'" alt="">\n                </a>\n                                <span class="item-name">\n                                    '+t.itemname+'\n                                </span>\n                                <span class="pretype">\n                                    <em>'+t.pretype+"</em>\n                                    "+t.pretypetitle+'\n                                </span>\n                                <span class="item-price ">\n                                    <em>￥</em>\n                                    <span>'+t.itemprice+'</span>\n                                </span>\n                                <a class="shop-car fr" href="javascript:void(0)" style="color:white">\n                                    加入购物车\n                </a>\n                                <span class="assnum ">评价:<em>'+t.assnum+"</em>条 </span>\n            </li>"}).join("");n.html(a)}}),$.ajax({type:"post",url:"../api/goodlist.php",data:{page:1,qty:12,m:"zhonghe"},success:function(t){a(t)}}),$("#page").on("click",function(a){a=a||window.event;var t=$(this).siblings(".listbox-mian").find(".sortactive");if("span"==a.target.tagName.toLowerCase()&&"综合"==t.find(".zhonghe").html()){var n=a.target.innerHTML;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:12,page:n,m:"zhonghe"},success:function(t){i(t,a)}})}}),$(".zhonghe").click(function(){$.ajax({type:"post",url:"../api/goodlist.php",data:{page:1,qty:12,m:"zhonghe"},success:function(t){a(t)}}),$("#page").on("click",function(a){a=a||window.event;var t=$(this).siblings(".listbox-mian").find(".sortactive");if("span"==a.target.tagName.toLowerCase()&&"综合"==t.find(".zhonghe").html()){var n=a.target.innerHTML;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:12,page:n,m:"zhonghe"},success:function(t){i(t,a)}})}$(this).find(".gt").click(function(){var t=$(this).parent().find("span");$(this).parent().find("span").size();console.log(t),console.log(t.eq(0))})})}),$(".xiaoliang").click(function(){$.ajax({type:"post",url:"../api/goodlist.php",data:{page:1,qty:12,m:"xiaoliang"},success:function(t){a(t)}}),$("#page").on("click",function(a){a=a||window.event;var t=$(this).siblings(".listbox-mian").find(".sortactive");if("span"==a.target.tagName.toLowerCase()&&"销量"==t.find(".xiaoliang").html()){var n=a.target.innerHTML;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:12,page:n,m:"xiaoliang"},success:function(t){i(t,a)}})}})}),$(".assnum").click(function(t){$.ajax({type:"post",url:"../api/goodlist.php",data:{page:1,qty:12,m:"assnum"},success:function(t){a(t)}}),$("#page").on("click",function(a){a=a||window.event;var t=$(this).siblings(".listbox-mian").find(".sortactive");if("span"==a.target.tagName.toLowerCase()&&"评价数"==t.find(".assnum").html()){var n=a.target.innerHTML;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:12,page:n,m:"assnum"},success:function(t){i(t,a)}})}})});var e=!0;$(".time").click(function(){e?($.ajax({type:"post",url:"../api/goodlist.php",data:{page:1,qty:12,m:"timedesc"},success:function(t){a(t)}}),$("#page").on("click",function(a){a=a||window.event;var t=$(this).siblings(".listbox-mian").find(".sortactive");if("span"==a.target.tagName.toLowerCase()&&"上新时间↑"==t.find(".time").html()){var n=a.target.innerHTML;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:12,page:n,m:"timedesc"},success:function(t){i(t,a)}})}}),$(this).html("上新时间↑")):($.ajax({type:"post",url:"../api/goodlist.php",data:{page:1,qty:12,m:"timeasc"},success:function(t){a(t)}}),$("#page").on("click",function(a){a=a||window.event;var t=$(this).siblings(".listbox-mian").find(".sortactive");if("span"==a.target.tagName.toLowerCase()&&"上新时间↓"==t.find(".time").html()){var n=a.target.innerHTML;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:12,page:n,m:"timeasc"},success:function(t){i(t,a)}})}}),$(this).html("上新时间↓")),e=!e});var p=!0;$(".price").click(function(){p?($.ajax({type:"post",url:"../api/goodlist.php",data:{page:1,qty:12,m:"pricedesc"},success:function(t){a(t)}}),$("#page").on("click",function(a){a=a||window.event;var t=$(this).siblings(".listbox-mian").find(".sortactive");if("span"==a.target.tagName.toLowerCase()&&"价格↓"==t.find(".price").html()){var n=a.target.innerHTML;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:12,page:n,m:"pricedesc"},success:function(t){i(t,a)}})}}),$(this).html("价格↓")):($.ajax({type:"post",url:"../api/goodlist.php",data:{page:1,qty:12,m:"priceasc"},success:function(t){a(t)}}),$("#page").on("click",function(a){a=a||window.event;var t=$(this).siblings(".listbox-mian").find(".sortactive");if("span"==a.target.tagName.toLowerCase()&&"价格↑"==t.find(".price").html()){var n=a.target.innerHTML;$.ajax({type:"post",url:"../api/goodlist.php",data:{qty:12,page:n,m:"priceasc"},success:function(t){i(t,a)}})}}),$(this).html("价格↑")),p=!p}),$(".sort-box li").click(function(){$(this).siblings().removeClass("sortactive").end().addClass("sortactive")})});