"use strict";$(function(){window.onscroll=function(){800<=window.scrollY?$(".gooddetailstopMenu").css("top",0):$(".gooddetailstopMenu").css("top",-100)};var o=decodeURI(location.search),n=o.slice(1),t=$("#itemshow");$.ajax({type:"post",url:"../api/gooddetails.php",data:"id="+n,success:function(n){var s=JSON.parse(n).map(function(n){return'\n                <section class="buyBox" >\n                    <section class="category">\n                        <span><a target="_blank" href="../html/index.html">首页</a> </span>&gt;\n                        <span><a target="_blank" href="javascript:void(0)">葡萄酒</a> </span>&gt;\n                        <span><a target="_blank" href="javascript:void(0)">红魔鬼</a></span>&gt;\n                        <span>'+n.itemname+'</span>\n                        <a class="zxkfbtn fr"></a>\n                    </section>\n                    <section class="itemshow clearfix" >\n                        <section class="glass fl">\n                        <section class="imgdet wrap fl">\n                        \x3c!-- 左侧图片列表 --\x3e\n                        <section class="imglist1 fl">\n                            <ul>\n                                <li class="">\n                                    <img src="'+n.img+'">\n                                </li>\n                                <li class="">\n                                    <img src="../img/details-img1.jpg">\n                                </li>\n                                <li class="">\n                                    <img src="'+n.img+'">\n                                </li>\n                                <li class="active">\n                                    <img src="../img/details-img1.jpg">\n                                </li>\n                                <li>\n                                    <img src="'+n.img+'">\n                                </li>\n                            </ul>\n                        </section>\n                        <section class="imgpart">\n                            \x3c!-- 图片展示 --\x3e\n                            <section class="pic">\n                                <img src="'+n.img+'">\n                                \x3c!-- 镜片 --\x3e\n                                <section class="magnify" style="display: none; top: 123px; left: 260px;"></section>\n                            </section>\n                            \x3c!-- 放大后的图片, 放大后的图片的尺寸要设置为展示图片的倍数（2倍）--\x3e\n                            <section class="bigpic" style="display: none;">\n                                <img src="'+n.img+'" alt="" style="top: -246px; left: -460px;">\n                            </section>\n                        </section>\n                    </section>\n                            <section class="itemmsg fl">\n                                <h3 class="itemtitle">'+n.itemname+'</h3>\n                                <p class="redad">.</p>\n                                <a class="sppp" href="javascript:void(0)">'+n.storename+'<br>\n                                    <em>官方自营</em>\n                                </a>\n                                <section class="priceBox">\n                                    <section class="newPriceBox">\n                                        <p class="newPrice fl" style="margin-top: 0">\n                                            活动价<strong><span class="rmbIcon">¥</span><span class="price"><span\n                                                        id="spPrice">'+n.itemprice+'</span></span></strong>\n                                        </p>\n                                        <section class="sale fl">\n                                            <span class="fl">促销信息</span>\n                                            <span>\n                                                <span class="redBox">购酒特惠</span>\n                                                <span class="red"></span>\n                                                <br>\n                                            </span>\n                                        </section>\n                                    </section>\n\n                                </section>\n                                <section class="upmsg">\n                                    <section class="transTo">\n                                        <section class="psz">配 送 至:</section>\n                                        <section class="at">\n                                            <a class="at_btn" id="spnProvince">\n                                                <label id="lbPP">上海 ∨</label>\n                                            </a>\n                                            <section class="addrArea" style="display: none;">\n                                                <section id="sectionRegion">\n                                                    <u class="u01" id="CloseArea"></u>\n                                                    <section class="AstoreBox c9" id="Region"\n                                                        data-templateid="RegionList">\n                                                    </section>\n                                                </section>\n                                            </section>\n                                        </section>\n                                        <span class="yh" id="freightSpan">单笔订单不满100元，收运费10元</span>\n                                        <img src="../img/car.png">\n                                        <sapn>满百包邮</sapn>\n                                    </section>\n                                </section>\n                                <section class="pay">\n                                    <p>\n                                        关注度<em>&nbsp;'+n.attention+'</em>\n                                    </p>\n                                    <span class="line"></span>\n                                    <p>\n                                        累计评价&nbsp;<a href="#Comment" id="AllComment" target="_self">'+n.assnum+'</a>\n                                    </p>\n                                    <span class="line"></span>\n                                    <p>\n                                        送积分<span>&nbsp;'+n.integral+'</span>\n                                    </p>\n                                </section>\n\n                                <section class="guanlbox clearfix" id="group">\n\n                                </section>\n\n                                <section class="numbox clearfix">\n                                    <section class="lttext fl">数 &nbsp;量:</section>\n                                    <section class=\'fr\' style="color:red" id="inventory">库 &nbsp;存:  &nbsp; '+n.inventory+'</section>\n                                    <section class="fl">\n                                        <input class="nums" id="txtQuantity" value="1" type="text">\n                                        <section class="addBtn">\n                                            <span class="addN">+</span><span class="diffN">-</span>\n                                        </section>\n                                    </section>\n\n                                    <span class="fl" id="xg"></span>\n                                    <span id="spanChoose"> </span>\n\n                                </section>\n\n                                <section class="buybox">\n                                    <a class="buy" href="../html/shoppingCart.html" style="color:white">\n                                        立即购买\n                                    </a>\n\n                                    <a class="addshopcar" id="addcar" style="color:white" href= "javascript:void(0)">\n                                    加入购物车\n                                    </a>\n\n                                </section>\n                            </section>\n                        </section>\n                    </section>\n                </section>\n                '}).join("");t.html(s)}}),t.on("click",".addN",function(n){var s=1*$(this).parent().parent().find("#txtQuantity").val();$(this).parent().parent().find("#txtQuantity").text(s),$(this).parent().parent().find("#txtQuantity").val(s);var t=1*$("#inventory").html().substr(19,20);s<t?s++:s=t,$(this).parent().parent().find("#txtQuantity").val(s)}),t.on("click",".diffN",function(n){var s=1*$(this).parent().parent().find("#txtQuantity").val();$(this).parent().parent().find("#txtQuantity").text(s),$(this).parent().parent().find("#txtQuantity").val(s);$("#inventory").html().substr(19,20);s<=1?s=1:s--,$(this).parent().parent().find("#txtQuantity").val(s)}),t.on("mouseover",".itemmsg",function(n){var s=$("#AllComment").html();$(".pingjia").find("em").html("("+s+")"),$("#jy").find("em").html("("+s+")");var t=$("#spPrice").html();$(".pri").html("￥"+t)});var p=$("#end").offset();t.on("click","#addcar",function(n){n=n||window.event;var s=$(this).parent().parent().parent().find("img").attr("src");console.log(s),$('<img class="u-flyer" src="'+s+'">').fly({start:{left:n.clientX,top:n.clientY},end:{left:p.left-20,top:p.top+30,width:0,height:0},onEnd:function(){$("#msg").show().animate({width:"250px"},200).fadeOut(1e3)}});var t=o.slice(1),i=$(this).parents(".itemmsg").find(".itemtitle").html(),a=$(this).parents(".glass").find(".pic").find("img").attr("src"),e=$(this).parents(".itemmsg ").find(".priceBox").find("#spPrice").html(),c=1*$(this).parent().parent().find("#txtQuantity").val(),l=1*$("#inventory").html().substr(19,20);$.ajax({type:"post",url:"../api/shopcar.php",data:{id:t,name:i,imgurl:a,price:e,qty:c,inventory:l,m:"add"},success:function(n){}})}),t.on("mouseover",".pic",function(n){!function(){var n=$(".imglist1 ul"),s=$(".imgpart .pic img"),h=$(".imgpart .bigpic img");n.on("mouseenter","li",function(){var n=$(this).children("img").attr("src");$(this).addClass("active").siblings().removeClass("active"),s.attr("src",n),h.attr("src",n)});var u=$(".imgpart .pic"),v=$(".imgpart .pic .magnify"),x=$(".imgpart .bigpic");h=$(".imgpart .bigpic img");u.mousemove(function(n){v.show(),x.show();var s=n.pageX,t=n.pageY,i=u.offset().top,a=u.offset().left,e=v.width(),c=v.height(),l=t-i-c/2,o=s-a-e/2,p=u.width()-e,r=u.height()-c;l=r<(l=l<0?0:l)?r:l,o=p<(o=o<0?0:o)?p:o,v.css({top:l,left:o});var m=x.width()-h.width(),d=x.height()-h.height(),g=2*-o,f=2*-l;g=g<m?m:g,f=f<d?d:f,h.css({top:f,left:g})}),u.mouseleave(function(){v.hide(),x.hide()})}()})});